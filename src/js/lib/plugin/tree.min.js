+function(b){!function(c){"function"==typeof define&&define.amd?define(["jquery"],c):"object"==typeof exports?module.exports=c:c(jQuery)}(function(v){function n(z){var e,B,A,y=z||b.event,x=s.call(arguments,1),w=0,l=0,k=0,i=0,g=0,f=0;return z=v.event.fix(y),z.type="mousewheel","detail" in y&&(k=-1*y.detail),"wheelDelta" in y&&(k=y.wheelDelta),"wheelDeltaY" in y&&(k=y.wheelDeltaY),"wheelDeltaX" in y&&(l=-1*y.wheelDeltaX),"axis" in y&&y.axis===y.HORIZONTAL_AXIS&&(l=-1*k,k=0),w=0===k?l:k,"deltaY" in y&&(k=-1*y.deltaY,w=k),"deltaX" in y&&(l=y.deltaX,0===k&&(w=-1*l)),0!==k||0!==l?(1===y.deltaMode?(e=v.data(this,"mousewheel-line-height"),w*=e,k*=e,l*=e):2===y.deltaMode&&(B=v.data(this,"mousewheel-page-height"),w*=B,k*=B,l*=B),i=Math.max(Math.abs(k),Math.abs(l)),(!q||q>i)&&(q=i,a(y,i)&&(q/=40)),a(y,i)&&(w/=40,l/=40,k/=40),w=Math[w>=1?"floor":"ceil"](w/q),l=Math[l>=1?"floor":"ceil"](l/q),k=Math[k>=1?"floor":"ceil"](k/q),o.settings.normalizeOffset&&this.getBoundingClientRect&&(A=this.getBoundingClientRect(),g=z.clientX-A.left,f=z.clientY-A.top),z.deltaX=l,z.deltaY=k,z.deltaFactor=q,z.offsetX=g,z.offsetY=f,z.deltaMode=0,x.unshift(z,w,l,k),r&&clearTimeout(r),r=setTimeout(m,200),(v.event.dispatch||v.event.handle).apply(this,x)):void 0}function m(){q=null}function a(d,c){return o.settings.adjustOldDeltas&&"mousewheel"===d.type&&0===c%120}var r,q,p,o,u=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],t="onwheel" in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],s=Array.prototype.slice;if(v.event.fixHooks){for(p=u.length;p;){v.event.fixHooks[u[--p]]=v.event.mouseHooks}}o=v.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener){for(var c=t.length;c;){this.addEventListener(t[--c],n,!1)}}else{this.onmousewheel=n}v.data(this,"mousewheel-line-height",o.getLineHeight(this)),v.data(this,"mousewheel-page-height",o.getPageHeight(this))},teardown:function(){if(this.removeEventListener){for(var c=t.length;c;){this.removeEventListener(t[--c],n,!1)}}else{this.onmousewheel=null}v.removeData(this,"mousewheel-line-height"),v.removeData(this,"mousewheel-page-height")},getLineHeight:function(e){var g=v(e),f=g["offsetParent" in v.fn?"offsetParent":"parent"]();return f.length||(f=v("body")),parseInt(f.css("fontSize"),10)||parseInt(g.css("fontSize"),10)||16},getPageHeight:function(c){return v(c).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}},v.fn.extend({mousewheel:function(c){return c?this.bind("mousewheel",c):this.trigger("mousewheel")},unmousewheel:function(c){return this.unbind("mousewheel",c)}})})}(window,jQuery),+function(d,c){c.fn.addTree=function(n){var k,j,b,a,m={},l={showLog:!1,key:"mapId",parentKey:"pId",name:"xqmc",childKey:"children",data:[],cache:!1,cacheId:"wTreeLocalStorage",itemIdPrefix:"fd-tree-",operateItemClass:".tree-name",selectedIndex:0,selectedIsTriggerCallback:!1,goToTargetClass:"tree-hd-warning",selectedClass:"tree-hd-selected",disabledClass:"disabled",hoverClass:"tree-hd-hover",hideTrigerClass:"hide",collapseClass:"tree-hd-collapse",nodeNameClass:"tree-name",checkboxClass:"fd-checkbox",checkedClass:"fd-checked",treeContentClass:"ul-tree-ct",itemClass:"tree-item",itemHeadClass:"tree-hd",triggerClass:"fd-trigger",extendArea:!1,tweenTime:300,collapseChildren:!0,defaultCollapse:!0,defaultExpandIndex:0,hasAnimate:!0,hasCheckbox:!1,hasIcon:!0,type:2,lastItemClass:"tree-item-last",allowAppendNewNode:!0,canSelected:!0,hasHoverEffect:!0,onlyExpandOneLevel:!0,hasTips:!1,tipsTriggerElement:".tree-name",canSearch:!1,searchKey:["id","mapId"],searchName:["mc","xqmc","tsmc","rymc"],searchScrollTweenTime:400,searchInput:"#jsSearch",searchButton:"#jsBtnSearch",limitCount:5,deferTime:200,isAutocompleter:!0,hideAutocompleterClass:"hide",menuSelectedClass:"selected",autocompleterContain:"#jsAutocompleter",treeContain:"#jsTreeContain",autocompleterIsAjax:!1,autocompleterAjax:{url:"json/search.json",method:"get",data:"nr",dataType:"json",asych:!0,success:function(){console.log("成功")},error:function(){console.log("失败")}},hasScrollBar:!0,scrollBarContain:".fd-scroll-track",scrollBarClass:"fd-scroll-bar",pressClass:"pressed",scrollBarMinHeight:50,scrollStep:10,scrollTweenTime:10,callback:{appendNewNode:function(g,p,o,i){var h=g.data("mapid");c.ajax({url:"json/ry.json",dataType:"json",data:h,method:"get",cache:!1,crossDomain:!1,timeout:2000,async:!1,success:function(e){var s=e.result.dataList,r=parseInt(g.attr("level"))+1,q=i.view.appendNodes(s,r,0,[{key:"tsid",name:"tsmc",childKey:"ryList",collapseChildren:!0,className:"tree-ts",allowAppendNewNode:!1,canSelected:!1,hasHoverEffect:!1,hasTips:!1},{key:"ryid",name:"rymc",childKey:"",collapseChildren:!0,className:"tree-ts",allowAppendNewNode:!1,canSelected:!1,hasHoverEffect:!1,hasTips:!1}]);g.siblings("."+i.opts.treeContentClass)[0].innerHTML=q}})},tips:function(){},onMouseenter:function(){},onMouseleave:function(){},onMmousemove:function(){},onNodeCreated:function(){console.log("节点被创建的事件")},onClick:function(){console.log("点击事件")},onDblClick:function(){console.log("双击事件")},onMouseDown:function(){console.log("鼠标按下事件")},onMouseUp:function(){console.log("鼠标按松开事件")},onExpand:function(f,e,h,g){console.log("展开的回调函数"),g.scrollBar.update(20)},onCollapse:function(f,e,h,g){console.log("收起的回调函数"),g.scrollBar.update(20)},onDestory:function(){console.log("销毁的回调函数")},checked:function(f,e,g){console.log("阻止冒泡"),console.log(g)},unchecked:function(f,e,g){console.log("阻止冒泡uncheck"),console.log(g)},search:function(i,t,s,r,q){var o,p=c("#"+r.opts.itemIdPrefix+i);p.size()<1?(o=c("#"+r.opts.itemIdPrefix+q.fyid),o.size()>0&&r.opts.allowAppendNewNode&&(r.opts.showLog&&console.log("不存在了，需要添加节点"),r.opts.callback.appendNewNode(o,t,s,r))):r.opts.showLog&&console.log("自己玩去吧，已经存在了")},selected:function(g,f){var h,i=m._this.find(m.opts.operateItemClass).eq(g);i.size()>0&&(h=m._this.find("."+m.opts.selectedClass),h.size()>0&&h.removeClass(m.opts.selectedClass),i.addClass(m.opts.selectedClass),f&&i.trigger("click.tree"))}}};return m.opts=c.extend(!0,{},l,n||{}),m._this=c(this),m.cacheId=m.opts.cacheId+m._this.attr("id"),k=d.navigator.appVersion.toUpperCase(),k.indexOf("MSIE")&&(j=k.indexOf("MSIE"),b=k.indexOf(";",j+4),a=parseInt(k.substring(j+4,b)),8>a&&(m.opts.tweenTime=10)),m.init=function(){return m.view.createTree(),m.bindEvent.normal(),m.defaultExpand(),m.opts.hasTips&&m.createTipsBox(),m},m.update=function(e){m.opts.data=e,m.view.createTree(),m.defaultExpand(),m.opts.hasScrollBar&&setTimeout(function(){m.scrollBar.update(20)},100)},m.defaultSelected=function(e,f){"number"===c.type(e)&&("boolean"===c.type(f)?m.opts.callback.selected(e,f):m.opts.callback.selected(e))},m.setWhatItemCanSelected=function(f,h){if("number"===c.type(f)){var g=!1;"boolean"===c.type(h)&&(g=h),g?m._this.find("."+m.opts.itemHeadClass).each(function(){var p=c(this),o=parseInt(p.attr("level")),i=p.attr("canselected");o>f?c(this).attr("canselected","false"):"false"!==i&&c(this).attr("canselected","true")}):m._this.find("."+m.opts.itemHeadClass).each(function(){var i=c(this),e=i.attr("level");e>f&&i.attr("canselected","false")})}},m.createTipsBox=function(){m.tipsBox=c("<div></div>").css({position:"absolute",top:"0",left:"0","white-space":"nowrap",font:'12px/1.4em "Microsoft YaHei"',background:"rgba(0,0,0,0.5)","z-index":"99",padding:"5px 10px",display:"none",color:"#fff","border-radius":"5px"}),m.tipsBox.appendTo("body")},m.data={transformTozTreeFormat:function(o){var v,u,q,p,t=m.opts.key,s=m.opts.parentKey,r=m.opts.childKey;return t&&""!=t&&o?c.isArray(o)?(q=[],p={},function(){for(var e=0,f=o.length;f>e;e++){p[o[e][t]]=o[e]}e=null,f=null}(),function(){for(v=0,u=o.length;u>v;v++){p[o[v][s]]&&o[v][t]!=o[v][s]?(p[o[v][s]][r]||(p[o[v][s]][r]=[]),p[o[v][s]][r].push(o[v])):q.push(o[v])}}(),q):[o]:[]}},m.view={createTree:function(){var e="";return m.opts.cache?d.localStorage.getItem(m.cacheId)?(e=d.localStorage.getItem(m.cacheId),m.opts.data=JSON.parse(d.localStorage.getItem(m.cacheId+"data"))):(m.opts.data=m.data.transformTozTreeFormat(m.opts.data),e=m.view.appendNodes(m.opts.data,1),d.localStorage.setItem(m.cacheId,e),d.localStorage.setItem(m.cacheId+"data",JSON.stringify(m.opts.data))):(m.opts.data=m.data.transformTozTreeFormat(m.opts.data),e=m.view.appendNodes(m.opts.data,1)),m._this[0].innerHTML=e,m},appendNodes:function(N,M,L,K){var J,I,H,G,F,E,D,C,B,A,z,y,x,w,v;if(!N){return[]}for(J=[],I=m.opts.key,H=m.opts.childKey,G=m.opts.allowAppendNewNode,F=m.opts.collapseChildren,E=m.opts.name,D=m.opts.canSelected,C=m.opts.hasHoverEffect,B="",A=m.opts.hasTips,"number"===c.type(L)&&"array"===c.type(K)&&(L=L,I=K[L].key?K[L].key:I,H=K[L].childKey?K[L].childKey:H,"undefined"!==K[L].allowAppendNewNode&&(G=K[L].allowAppendNewNode),E=K[L].name?K[L].name:E,"undefined"!==K[L].collapseChildren&&(F=K[L].collapseChildren),"undefined"!==K[L].canSelected&&(D=K[L].canSelected),"undefined"!==K[L].hasHoverEffect&&(C=K[L].hasHoverEffect),B=K[L].className?K[L].className+"-"+L:B,"undefined"!==K[L].hasTips&&(A=K[L].hasTips)),z=0,y=N.length;y>z;z++){x=N[z],w=[],v=!1,x[H]&&x[H].length>0&&(v=!0,w=m.view.appendNodes(x[H],M+1,L+1,K)),m.view.makeDOMNodeMainBefore(J,M,z,y),m.view.makeDOMNodeNameBefore(J,x,M,I,H,F,G,B,D,C,A),m.view.makeDOMNodeTrigger(J,v,G),m.view.makeDOMNodeABefore(J,x),m.view.makeDOMNodeIcon(J),m.view.makeDOMNodeCheckbox(J),m.view.makeDOMNodeAAfter(J,x,E),m.view.makeDOMNodeNameAfter(J),m.view.makeUlHtml(J,w,M,v,F,B),m.view.makeDOMNodeMainAfter(J)}return J.join("")},makeDOMNodeMainBefore:function(h,g,p,o){var i=!1;2===m.opts.type?(p+1===o&&(i=!0),h.push('<li   class="'+m.opts.itemClass+" "+(i?m.opts.lastItemClass:"")+"  tree-item-0"+g+'"   >')):h.push('<li   class="'+m.opts.itemClass+"  tree-item-0"+g+'"   >')},makeDOMNodeNameBefore:function(A,z,y,x,w,v,u,t,s,r,q){var o,p=[];u=u,v=v,s=s,"undefined"!=typeof z.canSelected&&(s=z.canSelected),q=q;for(name in z){""===z[name]&&(z[name]="false"),name!==w&&p.push("data-"+name+"="+z[name])}o=m.opts.itemHeadClass+" "+(z.disabled?m.opts.disabledClass:"")+" tree-hd-0"+y,v&&(o=o+" "+m.opts.collapseClass),t&&(o=o+" "+t),A.push(' <h3 hastips="'+q+'" canselected="'+s+'"  hover="'+r+'"   allowAppendNewNode="'+u+'"  level="'+y+'"    '+p.join(" ")+'  id="'+m.opts.itemIdPrefix+z[x]+'"  class="'+o+'"> ')},makeDOMNodeTrigger:function(g,f,i){var h=m.opts.triggerClass;f||i||(h=m.opts.triggerClass+" "+m.opts.hideTrigerClass),g.push(' <span class="'+h+'"></span>')},makeDOMNodeABefore:function(f,e){e.url?f.push(' <a href="'+e.url+'" hidefocus="true"  class="'+m.opts.nodeNameClass+'"  >'):f.push(' <a href="javascript:void(0);" hidefocus="true"  class="'+m.opts.nodeNameClass+'"  >')},makeDOMNodeIcon:function(e){m.opts.hasIcon&&e.push('<span class="fd-icon"  title="图标容器">图标</span>')},makeDOMNodeCheckbox:function(e){m.opts.hasCheckbox&&e.push(' <span class="'+m.opts.checkboxClass+'"><input type="checkbox" name=""   /></span>')},makeDOMNodeAAfter:function(f,e,g){f.push(e[g]+"</a>")},makeDOMNodeNameAfter:function(e){e.push("</h3>")},makeUlHtml:function(p,o,v,u,t,s){var q,r="";t&&(r="style=display:none;"),q=m.opts.treeContentClass+" ul-tree-ct-0"+v,s&&(q=q+" "+s),u?p.push(" <ul "+r+'  class="'+q+' ">'+o+"</ul>"):p.push(" <ul "+r+'   class="'+q+'"></ul>')},makeDOMNodeMainAfter:function(e){e.push("</li>")}},m.destory=function(){m.unbindEvent.allEvent(),m.html("")},m.animate=function(i,t,s,r,q,p,o){return s.is(":animated")?!1:(o.opts.hasAnimate||(o.opts.tweenTime=0),i?(t.removeClass(o.opts.collapseClass),o.opts.onlyExpandOneLevel&&s.parent().siblings().each(function(){var e=c(this),g=e.children("."+o.opts.itemHeadClass),f=g.hasClass(o.opts.collapseClass);f||g.addClass(o.opts.collapseClass).next("."+o.opts.treeContentClass).slideUp(o.opts.tweenTime)}),s.stop(!0,!0).slideDown(o.opts.tweenTime,function(){"function"===c.type(o.opts.callback.onExpand)&&o.opts.callback.onExpand(r,q,p,o)})):(t.addClass(o.opts.collapseClass),s.stop(!0,!0).slideUp(o.opts.tweenTime/o.opts.tweenTime,function(){"function"===c.type(o.opts.callback.onCollapse)&&o.opts.callback.onCollapse(r,q,p,o)})),void 0)},m.bindEvent={getTarget:function(f){var e;return f=f||d.event,e=c(f.target)},stopBubble:function(e){e.stopPropagation()},normal:function(){m.bindEvent.mouseenter(),m.bindEvent.mouseleave(),m.bindEvent.click(),m.bindEvent.toggleChecked(),m.bindEvent.toggleSlide(),m.opts.hasTips&&(m.bindEvent.mouseenter(),m.bindEvent.mouseleave(),m.bindEvent.mousemove())},all:function(){m.bindEvent.mouseenter(),m.bindEvent.mouseleave(),m.bindEvent.mousemove(),m.bindEvent.click(),m.bindEvent.dblclick(),m.bindEvent.mouseDown(),m.bindEvent.mouseUp(),m.bindEvent.toggleChecked(),m.bindEvent.toggleSlide()},mouseenter:function(){m._this.off("mouseenter.tree").on("mouseenter.tree","."+m.opts.itemHeadClass,function(r){var p,o,i,q=c(this);r=r||d.event,p=m.bindEvent.getTarget(r),"true"===q.attr("hover")&&(q.addClass(m.opts.hoverClass),"function"===c.type(m.opts.callback.onMouseenter)&&m.opts.callback.onMouseenter(q,r,p,m)),"true"===q.attr("hastips")&&p.is(m.opts.tipsTriggerElement)&&(o=r.pageY,i=r.pageX,m.tipsBox.text(q.find("a").text()).css({top:o,left:i+20,display:"block"}),"function"===c.type(m.opts.callback.tips)&&m.opts.callback.tips(q,r,p,m))})},mouseleave:function(){m._this.off("mouseleave.tree").on("mouseleave.tree","."+m.opts.itemHeadClass,function(f){var g,h=c(this);h.hasClass(m.opts.hoverClass)&&h.removeClass(m.opts.hoverClass),"true"===h.attr("hastips")&&m.tipsBox.is(":visible")&&m.tipsBox.css({display:"none"}),g=m.bindEvent.getTarget(f),"function"===c.type(m.opts.callback.onMouseleave)&&m.opts.callback.onMouseleave(h,f,g,m)})},mousemove:function(){m._this.off("mousemove.tree").on("mousemove.tree","."+m.opts.itemHeadClass,function(r){var o,i,q=c(this),p=m.bindEvent.getTarget(r);r=r||d.event,"true"===q.attr("hastips")&&(o=r.pageY,i=r.pageX,p.is(m.opts.tipsTriggerElement)?(m.tipsBox.is(":hidden")&&m.tipsBox.css({display:"block"}),m.tipsBox.css({top:o,left:i+20})):m.tipsBox.is(":visible")&&m.tipsBox.css({display:"none"})),"function"===c.type(m.opts.callback.onMouseleave)&&m.opts.callback.onMmousemove(q,r,p,m)})},click:function(){m._this.off("click.tree").on("click.tree",m.opts.operateItemClass,function(i){var o,s=c(this),r=s.closest("."+m.opts.itemHeadClass),q=m.bindEvent.getTarget(i),p=q.is("."+m.opts.triggerClass);return p&&!m.opts.extendArea?(m.opts.showLog&&console.log("_scope.opts.extendArea为false,点击fd-trigger元素阻止默认事件"),void 0):(o=m._this.find("."+m.opts.goToTargetClass),o.size()>0&&o.removeClass(m.opts.goToTargetClass),"true"===r.attr("canselected")&&(r.hasClass(m.opts.selectedClass)?m.opts.showLog&&console.log("点击"+m.opts.operateItemClass+",该条数据已经是选中状态，无需执行click函数；"):(m._this.find("."+m.opts.selectedClass).removeClass(m.opts.selectedClass),r.addClass(m.opts.selectedClass),"function"===c.type(m.opts.callback.onClick)&&m.opts.callback.onClick(s,i,q,m),m.opts.showLog&&console.log("点击"+m.opts.operateItemClass+",该条数据增加选中状态，执行click函数；"))),void 0)})},dblclick:function(){m._this.off("dblclick.tree").on("dblclick.tree",m.opts.operateItemClass,function(f){var h=c(this),g=m.bindEvent.getTarget(f);"function"===c.type(m.opts.callback.onDblClick)&&m.opts.callback.onDblClick(h,f,g,m)})},mouseDown:function(){m._this.off("mousedown.tree").on("mousedown.tree",m.opts.operateItemClass,function(f){var h=c(this),g=m.bindEvent.getTarget(f);"function"===c.type(m.opts.callback.onMouseDown)&&m.opts.callback.onMouseDown(h,f,g,m)})},mouseUp:function(){m._this.off("mouseup.tree").on("mouseup.tree",m.opts.operateItemClass,function(f){var h=c(this),g=m.bindEvent.getTarget(f);"function"===c.type(m.opts.callback.onMouseUp)&&m.opts.callback.onMouseUp(h,f,g,m)})},toggleChecked:function(){m.opts.hasCheckbox&&m._this.off("click.toggleChecked").on("click.toggleChecked","."+m.opts.checkboxClass,function(g){var o=c(this),i=m.bindEvent.getTarget(g),h=i.closest("."+m.opts.checkboxClass);return m.bindEvent.stopBubble(g),h.closest("."+m.opts.itemHeadClass).hasClass(m.opts.disabledClass)?(g.preventDefault(),void 0):(h.hasClass(m.opts.checkedClass)?(h.removeClass(m.opts.checkedClass),"function"===c.type(m.opts.callback.unchecked)&&(m.opts.callback.unchecked(o,g,i,m),m.opts.showLog&&console.log("点击"+m.opts.checkboxClass+",有选中类名"+m.opts.checkedClass+"取消选中，那么执行unchecked函数；"))):(h.addClass(m.opts.checkedClass),"function"===c.type(m.opts.callback.checked)&&(m.opts.callback.checked(o,g,i,m),m.opts.showLog&&console.log("点击"+m.opts.checkboxClass+",没有选中类名"+m.opts.checkedClass+"选中checkbox，那么执行checked函数；"))),void 0)})},toggleSlide:function(){m._this.off("click.toggleSlide").on("click.toggleSlide","."+m.opts.itemHeadClass,function(o){var u=c(this),t=m.bindEvent.getTarget(o),s=t.closest("."+m.opts.itemHeadClass),r=s.hasClass(m.opts.collapseClass),q=s.next("."+m.opts.treeContentClass),p=""===c.trim(q.text())?!0:!1;if(!s.hasClass(m.opts.disabledClass)){if(p){if(!m.opts.allowAppendNewNode){return m.opts.showLog&&console.log("click.toggleSlide事件，没有子元素直接返回！"),void 0}m.opts.extendArea?"function"===c.type(m.opts.callback.appendNewNode)&&(console.log("extend"),m.opts.callback.appendNewNode(u,o,t,m)):t.is("."+m.opts.triggerClass)&&"function"===c.type(m.opts.callback.appendNewNode)&&m.opts.callback.appendNewNode(u,o,t,m)}m.opts.extendArea?(m.animate(r,s,q,u,o,t,m),m.opts.showLog&&console.log("click.toggleSlide事件，有子元素，是扩大区域，点击整条都能执行动画有效")):t.is("."+m.opts.triggerClass)&&(m.animate(r,s,q,u,o,t,m),m.opts.showLog&&console.log("click.toggleSlide事件，有子元素，不是扩大区域，点击trigger元素才能执行动画"))}})}},m.unbindEvent={mouseenter:function(){m._this.off("mouseenter.tree")},mouseleave:function(){m._this.off("mouseleave.tree")},click:function(){m._this.off("click.tree")},dblclick:function(){m._this.off("dblclick.tree")},mouseDown:function(){m._this.off("mouseDown.tree")},mouseUp:function(){m._this.off("mouseUp.tree")},toggleChecked:function(){m._this.off("click.toggleChecked")},toggleSlide:function(){m._this.off("click.toggleSlide")},all:function(){m.unbindEvent.mouseenter(),m.unbindEvent.mouseleave(),m.unbindEvent.click(),m.unbindEvent.dblclick(),m.unbindEvent.mouseDown(),m.unbindEvent.mouseUp(),m.unbindEvent.toggleChecked(),m.unbindEvent.toggleSlide()},normal:function(){m.unbindEvent.mouseenter(),m.unbindEvent.mouseleave(),m.unbindEvent.click(),m.unbindEvent.toggleChecked(),m.unbindEvent.toggleSlide()}},m.defaultExpand=function(){"number"==typeof m.opts.defaultExpandIndex&&m._this.children().eq(m.opts.defaultExpandIndex).children("."+m.opts.itemHeadClass).removeClass(m.opts.collapseClass).next("."+m.opts.treeContentClass).css("display","block")},m.search={searchButton:c(m.opts.searchButton),searchInput:c(m.opts.searchInput),treeContain:c(m.opts.treeContain),autocompleterContain:c(m.opts.autocompleterContain),goToTarget:function(f){var g,h=c("#"+m.opts.itemIdPrefix+f);m._this.find("."+m.opts.goToTargetClass).removeClass(m.opts.goToTargetClass),h.addClass(m.opts.goToTargetClass),h.parents("."+m.opts.treeContentClass).each(function(){var e=c(this),i=e.siblings("."+m.opts.itemHeadClass);i.hasClass(m.opts.collapseClass)&&i.removeClass(m.opts.collapseClass),e.is(":hidden")&&e.show()}),g=h.position().top,m.opts.hasScrollBar?m.scrollBar.update(m.opts.searchScrollTweenTime,g):m.search.treeContain.stop(!0,!0).animate({scrollTop:g},m.opts.searchScrollTweenTime)},callback:{search:function(o,v){var s,r,q,p,u=m.search.searchInput.data(),t="";for(s=0,r=m.opts.searchKey.length;r>s;s++){if(u[m.opts.searchKey[s]]){t=u[m.opts.searchKey[s]];break}}"function"===c.type(m.opts.callback.search)&&""!==t&&m.opts.callback.search(t,o,v,m,u),t?(m.search.goToTarget(t),m.search.searchInput.trigger("blur.autocompleter")):(q=c.trim(m.search.searchInput.val()),""!==q?(p=!0,c.each(m.autocompleter.response,function(x,w){var f,e,i="";for(f=0,e=m.opts.searchName.length;e>f;f++){if(w[m.opts.searchName[f]]){i=m.opts.searchName[f];break}}if(w[i]===q){for(m.search.searchInput.data(w),p=!1,u=w,f=0,e=m.opts.searchKey.length;e>f;f++){if(u[m.opts.searchKey[f]]){t=u[m.opts.searchKey[f]];break}}return"function"===c.type(m.opts.callback.search)&&m.opts.callback.search(t,o,v,m,u),m.search.goToTarget(t),m.search.searchInput.trigger("blur.autocompleter"),!1}}),p&&m.search.searchInput.focus()):m.search.searchInput.focus())}}},m.autocompleter={timer:null,response:[],copyValueToSearch:function(i){var h,r,q,p,o;if(h=i?i:m.search.autocompleterContain.find("."+m.opts.menuSelectedClass),h.size()>0){for(r=h.data(),m.search.searchInput.removeData(),m.search.searchInput.data(r),q="",p=0,o=m.opts.searchName.length;o>p;p++){if(r[m.opts.searchName[p]]){q=r[m.opts.searchName[p]];break}}m.search.searchInput.val(q),m.autocompleter.hideAutocompleter()}},hideAutocompleter:function(){c(m.search.autocompleterContain).addClass(m.opts.hideAutocompleterClass)},showAutocompleter:function(){c(m.search.autocompleterContain).removeClass(m.opts.hideAutocompleterClass)},query:function(o,u,t,s){var r,q,p;if(s){m.opts.showLog&&(console.log("发送到后台的数据是："),console.log({param:JSON.parse('{"'+m.opts.autocompleterAjax.data+'":"'+o+'"}')}),console.log("\n")),c.ajax({url:m.opts.autocompleterAjax.url,method:m.opts.autocompleterAjax.method,dataType:m.opts.autocompleterAjax.dataType,data:{param:'{"'+m.opts.autocompleterAjax.data+'":"'+o+'"}'},success:function(i,h,e){m.opts.showLog&&(console.log("后台返回的数据是："),console.log(i),console.log("\n")),"array"===c.type(i.result)?i.result.length>0&&(m.autocompleter.response=i.result,i.result.length>t&&(m.autocompleter.response=m.autocompleter.response.slice(0,t))):m.autocompleter.response=[],m.autocompleter.makeList(o),"function"===c.type(m.opts.autocompleterAjax.success)&&m.opts.autocompleterAjax.success(i,h,e,m)},error:function(f,h,g){"function"===c.type(m.opts.autocompleterAjax.error)&&m.opts.autocompleterAjax.error(f,h,g,m)}})}else{if(u=u,t=t,m.autocompleter.response.length>=t){return !1}for(r=0,q=u.length;q>r&&(p=u[r],-1!==p[m.opts.name].search(o)&&m.autocompleter.response.push(p),p[m.opts.childKey]&&p[m.opts.childKey].length>0&&m.autocompleter.query(o,p[m.opts.childKey],t),!(m.autocompleter.response.length>=t));r++){}}},makeList:function(x){var v,u,t,s,r,q,p,o,w=m.autocompleter.response.length;if(w>0){for(v=['<ul class="fd-search-menu">'],u=0;w>u;u++){t=m.autocompleter.response[u],s=[];for(o in t){o!==m.opts.childKey&&(""===t[o]&&(t[o]="false"),s.push("data-"+o+"="+t[o]))}for(s=s.join(" "),r="",q=0,p=m.opts.searchName.length;p>q;q++){if(t[m.opts.searchName[q]]){r=m.opts.searchName[q];break}}o=t[r].split(x).join("<em>"+x+"</em>"),v.push('<li  class="fd-item" '+s+">"+o+"</li>")}v.push("</ul>"),m.search.autocompleterContain[0].innerHTML=v.join(""),m.search.autocompleterContain.removeClass(m.opts.hideAutocompleterClass),m.opts.isAutocompleter||m.search.autocompleterContain.addClass(m.opts.hideAutocompleterClass)}else{m.search.autocompleterContain.html('<div class="fd-empty-contain">未找到符合条件的数据</div>').removeClass(m.opts.hideAutocompleterClass),m.search.searchInput.removeData(),m.opts.isAutocompleter||m.search.autocompleterContain.addClass(m.opts.hideAutocompleterClass)}},ignoredKeyCod:[9,13,17,19,20,27,33,34,35,36,37,39,44,92,113,114,115,118,119,120,122,123,144,145],bindEvent:function(){m.search.searchInput.off("keydown.autocompleter").on("keydown.autocompleter",m.autocompleter.keydown),m.search.searchInput.off("keyup.autocompleter").on("keyup.autocompleter",m.autocompleter.keyup),m.search.searchInput.off("focus.autocompleter").on("focus.autocompleter",m.autocompleter.focus),m.search.searchInput.off("blur.autocompleter").on("blur.autocompleter",m.autocompleter.blur),m.search.autocompleterContain.off("mousedown.autocompleter").on("mousedown.autocompleter","li",m.autocompleter.mousedown)},keydown:function(f){var e=f.keyCode?f.keyCode:f.which;f.data,40===e||38===e?(f.preventDefault(),f.stopPropagation()):39===e||13===e&&(f.preventDefault(),f.stopPropagation())},search:function(){var e=c.trim(m.search.searchInput.val());""!==e?(m.autocompleter.response=[],m.opts.autocompleterIsAjax?m.autocompleter.query(e,m.opts.data,m.opts.limitCount,!0):(m.autocompleter.query(e,m.opts.data,m.opts.limitCount),m.autocompleter.makeList(e))):c(m.search.autocompleterContain).hasClass(m.opts.hideAutocompleterClass)||m.autocompleter.hideAutocompleter()},focus:function(){m.autocompleter.search()},blur:function(){m.autocompleter.hideAutocompleter(),m.search.searchInput.removeData()},keyup:function(h){var p,o,i;if(h.data,p=h.keyCode?h.keyCode:h.which,40===p||38===p){if(c(m.search.autocompleterContain).hasClass(m.opts.hideAutocompleterClass)||c(m.search.autocompleterContain).find("ul").size()<1){return}o=-1,i=m.search.autocompleterContain.find("."+m.opts.menuSelectedClass),i.size()>0&&(o=i.index()),40==p?(o++,o>=m.autocompleter.response.length&&(o=0)):38==p&&(o--,0>o&&(o=m.autocompleter.response.length-1)),m.search.autocompleterContain.find("ul").children().removeClass(m.opts.menuSelectedClass).eq(o).addClass(m.opts.menuSelectedClass)}else{-1===c.inArray(p,m.autocompleter.ignoredKeyCod)?(m.autocompleter.timer&&(clearTimeout(m.autocompleter.timer),m.autocompleter.timer=null),m.autocompleter.timer=setTimeout(function(){m.autocompleter.search()},m.opts.deferTime)):(13===p&&(m.search.autocompleterContain.hasClass(m.opts.hideAutocompleterClass)?m.search.searchButton.trigger("click.search"):(m.autocompleter.copyValueToSearch(),m.search.searchButton.trigger("click.search"))),m.opts.showLog&&console.log("禁用键"+p))}},mousedown:function(){m.autocompleter.copyValueToSearch(c(this)),m.search.searchButton.trigger("click.search")}},m.scrollBar={range:function(f,e,g){return Math.ceil(Math.min(e,Math.max(f,g)))},stopBubble:function(e){e.stopPropagation(),e.preventDefault()},createScrollBar:function(){m.scrollBar.trackContain.html('<span class="'+m.opts.scrollBarClass+'"></span>'),m.scrollBar.bar=m.scrollBar.trackContain.find("."+m.opts.scrollBarClass)},getParamHeight:function(){m.scrollBar.offsetHeight=m.scrollBar.parentContain.height(),m.scrollBar.scrollHeight=m.scrollBar.contentContain.innerHeight(),m.scrollBar.trackContainHeight=m.scrollBar.trackContain.innerHeight();var e=m.scrollBar.offsetHeight/m.scrollBar.scrollHeight*m.scrollBar.trackContainHeight;m.scrollBar.barHeight=Math.max(m.opts.scrollBarMinHeight,e),m.scrollBar.scrollMinDistance=0,m.scrollBar.scrollMaxDistance=m.scrollBar.trackContainHeight-m.scrollBar.barHeight,m.scrollBar.scrollAreaHeight=m.scrollBar.trackContainHeight-m.scrollBar.barHeight,m.scrollBar.bar.height(m.scrollBar.barHeight),m.scrollBar.offsetHeight>m.scrollBar.scrollHeight?m.scrollBar.trackContain.hide():m.scrollBar.trackContain.show()},update:function(o,u){var t,s,r,q,p;if("number"==c.type(u)){u=u,m.scrollBar.getParamHeight(),m.scrollBar.scrollHeight-u<m.scrollBar.offsetHeight&&(u=m.scrollBar.scrollHeight-m.scrollBar.offsetHeight),t=Math.abs(u)/(m.scrollBar.scrollHeight-m.scrollBar.offsetHeight)}else{if(m.scrollBar.scrollHeight===m.scrollBar.contentContain.innerHeight()&&m.scrollBar.offsetHeight===m.scrollBar.parentContain.height()){return}s=parseInt(m.scrollBar.contentContain.css("top"))?parseInt(m.scrollBar.contentContain.css("top")):0,t=Math.abs(s)/(m.scrollBar.scrollHeight-m.scrollBar.offsetHeight),r=m.scrollBar.scrollHeight,m.scrollBar.getParamHeight(),q=Math.abs(s)/(m.scrollBar.scrollHeight-m.scrollBar.offsetHeight),p=m.scrollBar.scrollHeight,t=p>r?Math.min(q,t):Math.max(q,t),t>1&&(t=1)}m.scrollBar.bar.stop(!0,!0).animate({top:m.scrollBar.scrollAreaHeight*t},o),m.scrollBar.contentContain.stop(!0,!0).animate({top:-Math.round((m.scrollBar.scrollHeight-m.scrollBar.offsetHeight)*t)},o)},moveFunction:function(g){var i,h,f=""==parseInt(m.scrollBar.bar.css("top"))?0:parseInt(m.scrollBar.bar.css("top"));f+=Number(g),i=m.scrollBar.range(f,m.scrollBar.scrollMaxDistance,m.scrollBar.scrollMinDistance),h=i/m.scrollBar.scrollAreaHeight,m.scrollBar.bar.stop(!0,!0).animate({top:i},m.opts.scrollTweenTime),m.scrollBar.contentContain.stop(!0,!0).animate({top:-(m.scrollBar.scrollHeight-m.scrollBar.offsetHeight)*h},m.opts.scrollTweenTime)},mousewheel:function(f){m.scrollBar.stopBubble(f);var e=f.deltaY,g=0;switch(e){case 1:g=-1*m.opts.scrollStep,m.scrollBar.moveFunction(g);break;case -1:g=m.opts.scrollStep,m.scrollBar.moveFunction(g)}},mousedown:function(r){var q=c(this),p=r.pageY,o=0,i=0;q.addClass(m.opts.pressClass),c(d).on("mousemove.scrollBar",function(e){m.scrollBar.stopBubble(e),i=e.pageY,o=i-p,p=i,m.scrollBar.moveFunction(o)}).on("mouseup.scrollBar",function(){c(d).off("mousemove.scrollBar"),c(d).off("mouseup.scrollBar"),q.removeClass(m.opts.pressClass)})},resize:function(){m.scrollBar.update(20)},bindEvent:function(){m.scrollBar.parentContain.on("mousewheel.scrollBar",m.scrollBar.mousewheel),m.scrollBar.parentContain.on("mousedown.scrollBar","."+m.opts.scrollBarClass,m.scrollBar.mousedown),c(d).on("resize.scrollBar",m.scrollBar.resize)},unbindEvent:function(){m.scrollBar.parentContain.off("mousewheel.scrollBar",m.scrollBar.mousewheel),m.scrollBar.parentContain.off("mousedown.scrollBar","."+m.opts.scrollBarClass,m.scrollBar.mousedown),c(d).off("resize.scrollBar")},init:function(){m.scrollBar.parentContain=c(m.opts.treeContain),m.scrollBar.parentContain.css({overflow:"hidden"}),m.scrollBar.trackContain=m.scrollBar.parentContain.children(m.opts.scrollBarContain),m.scrollBar.contentContain=m._this,m.scrollBar.createScrollBar(),m.scrollBar.getParamHeight(),m.scrollBar.bindEvent()},destory:function(){m.scrollBar.unbindEvent(),m.scrollBar.trackContain.html("")}},m.init(),m.opts.canSearch&&(m.autocompleter.bindEvent(),m.search.searchButton.off("click.search").on("click.search",function(g){var f;g=g||d.event,f=c(g.target),m.search.callback.search(g,f)})),m.opts.hasScrollBar&&m.scrollBar.init(),m}}(window,jQuery);
